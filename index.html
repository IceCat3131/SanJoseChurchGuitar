<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>å¬ä¼šè¯—æ­Œå‰ä»–è°±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="page">
    <header class="header">
      <h1>å¬ä¼šè¯—æ­Œå‰ä»–è°±</h1>
      <p class="subtitle">å¤§æœ¬ / å°æœ¬ è¯—æ­Œå‰ä»–è°± åœ¨çº¿é˜…è¯»</p>
    </header>

    <section class="controls">
      <div class="book-switch">
        <button id="btn-book-c" class="book-button active" data-book="c">å¤§æœ¬</button>
        <button id="btn-book-ts" class="book-button" data-book="ts">å°æœ¬</button>
      </div>
      <div class="search-area">
        <input id="search-no" type="number" min="1" placeholder="è¾“å…¥ç¼–å·ï¼Œå¦‚ 7 æˆ– 788">
        <!-- æ”¾å¤§é•œæŒ‰é’® -->
        <button id="search-btn" class="search-button" title="è·³è½¬åˆ°è¯¥ç¼–å·">
          ğŸ”
        </button>
        
      </div>
    </section>

    <section>
      <div id="song-list" class="song-list"></div>
    </section>

    <footer class="footer">
      <p>æœ¬ç½‘ç«™ä»…ä¾›è¯—æ­Œå‰ä»–è°±æŸ¥é˜…ä½¿ç”¨ã€‚</p>
    </footer>
  </div>

  <script>
    const HYMNBOOKS = {
      c: { id: "c", label: "å¤§æœ¬è¯—æ­Œ", prefix: "c", count: 1000 },
      ts: { id: "ts", label: "å°æœ¬è¯—æ­Œ", prefix: "ts", count: 1000 }
    };

    let currentBook = "c";

    const listDiv = document.getElementById("song-list");
    const searchInput = document.getElementById("search-no");
    const btnBookC = document.getElementById("btn-book-c");
    const btnBookTs = document.getElementById("btn-book-ts");
    const searchBtn = document.getElementById("search-btn");

    function pad4(n) {
      return String(n).padStart(4, "0");
    }

    // æ¸²æŸ“åˆ—è¡¨ï¼ˆè¾“å…¥æ•°å­—æ—¶ç”¨äºè¿‡æ»¤ï¼‰
    function renderList() {
      const bookCfg = HYMNBOOKS[currentBook];
      const filterNo = searchInput.value.trim();
      listDiv.innerHTML = "";

      const wrapper = document.createElement("div");
      wrapper.className = "song-list-inner";

      for (let i = 1; i <= bookCfg.count; i++) {
        if (filterNo && !String(i).includes(filterNo)) continue;
        const a = document.createElement("a");
        a.className = "song-item";
        a.href = `song.html?book=${bookCfg.id}&no=${i}`;
        a.textContent = `${bookCfg.label} ç¬¬ ${i} é¦– (${bookCfg.prefix}${pad4(i)})`;
        wrapper.appendChild(a);
      }

      if (!wrapper.childNodes.length) {
        const empty = document.createElement("div");
        empty.className = "empty-tip";
        empty.textContent = "æ²¡æœ‰æ‰¾åˆ°å¯¹åº”ç¼–å·ï¼Œå¯ä»¥å°è¯•æ¢ä¸ªæ•°å­—ã€‚";
        listDiv.appendChild(empty);
      } else {
        listDiv.appendChild(wrapper);
      }
    }

    // æ–°å¢ï¼šæ ¹æ®è¾“å…¥ç¼–å·ï¼Œç›´æ¥è·³è½¬
    function jumpToSong() {
      const bookCfg = HYMNBOOKS[currentBook];
      const val = searchInput.value.trim();
      if (!val) {
        alert("è¯·è¾“å…¥ç¼–å·ï¼Œä¾‹å¦‚ 7 æˆ– 788");
        return;
      }
      const no = parseInt(val, 10);
      if (isNaN(no) || no < 1 || no > bookCfg.count) {
        alert(`è¯·è¾“å…¥ 1 - ${bookCfg.count} ä¹‹é—´çš„ç¼–å·`);
        return;
      }
      // ç›´æ¥è·³è½¬åˆ°å¯¹åº”ä¹è°±
      location.href = `song.html?book=${bookCfg.id}&no=${no}`;
    }

    function switchBook(bookId) {
      currentBook = bookId;
      btnBookC.classList.toggle("active", bookId === "c");
      btnBookTs.classList.toggle("active", bookId === "ts");
      renderList();
    }

    btnBookC.addEventListener("click", () => switchBook("c"));
    btnBookTs.addEventListener("click", () => switchBook("ts"));

    // è¾“å…¥æ—¶è¿˜æ˜¯ä½œä¸ºã€Œè¿‡æ»¤åˆ—è¡¨ã€
    searchInput.addEventListener("input", renderList);

    // ç‚¹å‡»æ”¾å¤§é•œï¼šè·³è½¬
    searchBtn.addEventListener("click", jumpToSong);

    // å›è½¦é”®ï¼šä¹Ÿè·³è½¬
    searchInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        jumpToSong();
      }
    });

    // åˆå§‹æ¸²æŸ“
    renderList();
  </script>
</body>
</html>
